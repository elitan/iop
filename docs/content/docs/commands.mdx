---
title: Commands
description: Complete reference for all iop CLI commands
---

# Commands

Complete reference for all available iop CLI commands.

## `iop init`

Initialize a new iop project with configuration files.

### Usage

```bash
iop init
```

### What it does

- Creates `iop.yml` with basic configuration template
- Creates `.iop/secrets` file for sensitive environment variables
- Prompts you to add `.iop/secrets` to `.gitignore`

### Example Output

```bash
‚ùØ iop init
‚úì Created iop.yml
‚úì Created .iop/secrets
! Add .iop/secrets to your .gitignore file
```

### Generated Files

**`iop.yml`**:

```yaml
name: my-project

ssh:
  username: root

apps:
  web:
    image: my-project/web
    servers:
      - your-server.com
    build:
      context: .
      dockerfile: Dockerfile
    proxy:
      hosts:
        - example.com
      app_port: 3000
```

**`.iop/secrets`**:

```bash
# Add your secrets here
# DATABASE_URL=postgres://...
# API_KEY=your-secret-key
```

---

## `iop setup`

Prepare servers for deployment by installing Docker and setting up infrastructure.

### Usage

```bash
iop setup [service...]               # Set up servers for specific services
iop setup                           # Set up all servers
iop setup --verbose                 # Show detailed output
```

### Examples

```bash
iop setup                           # Set up all servers
iop setup web api                   # Set up only servers for web and api
iop setup --verbose                 # Detailed logging
```

### What it does

1. **Connects to servers** via SSH
2. **Installs Docker** if not present
3. **Creates Docker networks** for app communication
4. **Sets up reverse proxy** (Traefik) for automatic HTTPS
5. **Configures SSL** certificate automation via Let's Encrypt
6. **Verifies connectivity** and reports status

### Example Output

```bash
‚ùØ iop setup
Setting up servers for deployment...

[‚úì] server1.com
    ‚îú‚îÄ [‚úì] SSH connection verified
    ‚îú‚îÄ [‚úì] Docker installed and running
    ‚îú‚îÄ [‚úì] iop network created
    ‚îú‚îÄ [‚úì] Reverse proxy configured
    ‚îî‚îÄ [‚úì] SSL automation enabled

[‚úì] server2.com
    ‚îú‚îÄ [‚úì] SSH connection verified
    ‚îú‚îÄ [‚úì] Docker installed and running
    ‚îú‚îÄ [‚úì] iop network created
    ‚îú‚îÄ [‚úì] Reverse proxy configured
    ‚îî‚îÄ [‚úì] SSL automation enabled

‚úì All servers ready for deployment
```

---

## `iop deploy`

Deploy applications or services with zero downtime.

### Usage

```bash
iop deploy [app...]                 # Deploy specific apps
iop deploy                          # Deploy all apps
iop deploy --services               # Deploy services instead of apps
iop deploy --force                  # Skip git status checks
iop deploy --verbose                # Show detailed output
iop deploy -c config.yml            # Use specific config file
```

### Examples

```bash
iop deploy                          # Deploy all apps
iop deploy web                      # Deploy only the web app
iop deploy web api                  # Deploy web and api apps
iop deploy --services               # Deploy all services
iop deploy backend --force          # Force deploy (skip git checks)
iop deploy --verbose                # Detailed logging
iop deploy -c iop.staging.yml      # Use staging configuration
```

### Deployment Process

1. **Configuration validation** - Verify iop.yml syntax
2. **Git status check** - Ensure working directory is clean (unless `--force`)
3. **Infrastructure verification** - Check servers are ready
4. **Image building** - Build Docker images locally
5. **Image transfer** - Securely upload to servers via SSH
6. **Zero-downtime deployment** - Blue-green deployment strategy
7. **Health checks** - Verify new version is healthy
8. **Traffic switching** - Atomically switch traffic to new version
9. **Cleanup** - Remove old versions

### Example Output

```bash
‚ùØ iop deploy
Using Git SHA for release ID: a1b2c3d
Starting deployment with release a1b2c3d

[‚úì] Configuration loaded (2ms)
[‚úì] Git status verified (15ms)
[‚úì] Infrastructure ready (450ms)

Building Images
  [‚úì] web ‚Üí my-app/web:a1b2c3d (45.2s)
  [‚úì] api ‚Üí my-app/api:a1b2c3d (32.1s)

Deploying to Servers
  ‚îî‚îÄ server1.com
     ‚îú‚îÄ [‚úì] Loading web image (3.2s)
     ‚îú‚îÄ [‚úì] Zero-downtime deployment (2.8s)
     ‚îú‚îÄ [‚úì] Loading api image (2.1s)
     ‚îú‚îÄ [‚úì] Zero-downtime deployment (1.9s)
     ‚îî‚îÄ [‚úì] Configuring SSL proxy (0.8s)

[‚úì] Deployment completed successfully in 89.1s

Your apps are live at:
  ‚îú‚îÄ https://myapp.com (web)
  ‚îî‚îÄ https://api.myapp.com (api)
```

### Deploy Options

- **`--services`** - Deploy services (databases, caches) instead of apps
- **`--force`** - Skip git working directory checks
- **`--verbose`** - Show detailed build and deployment logs
- **`-c, --config`** - Use a specific configuration file

---

## `iop status`

Check the status of your deployments.

### Usage

```bash
iop status [app...]                 # Status of specific apps
iop status                          # Status of all apps
iop status --verbose                # Show detailed status
```

### Examples

```bash
iop status                          # All apps status
iop status web                      # Status of web app only
iop status web api                  # Status of web and api apps
iop status --verbose                # Detailed status information
```

### Example Output

```bash
‚ùØ iop status
üì± App: web
   Status: ‚úÖ RUNNING (green active)
   Replicas: 2/2 running
   Servers: server1.com, server2.com
   Last deployed: 2 hours ago (release a1b2c3d)
   Health: ‚úÖ All replicas healthy
   URL: https://myapp.com

üì± App: api
   Status: ‚úÖ RUNNING (blue active)
   Replicas: 1/1 running
   Servers: api.server.com
   Last deployed: 30 minutes ago (release b2c3d4e)
   Health: ‚úÖ All replicas healthy
   URL: https://api.myapp.com

üîß Service: postgres
   Status: ‚úÖ RUNNING
   Servers: db.server.com
   Image: postgres:15
   Health: ‚úÖ Ready
```

### Status Information

For each app/service, status shows:

- **Status** - Current state (RUNNING, STOPPED, ERROR, DEPLOYING)
- **Active color** - Which deployment slot is active (blue/green)
- **Replicas** - Number of running/desired replicas
- **Servers** - Which servers are hosting the app
- **Last deployed** - When and which release was last deployed
- **Health** - Health check status
- **URL** - Live application URLs

### Detailed Status

With `--verbose`, you get additional information:

- Container IDs and detailed status
- Resource usage (CPU, memory)
- Network configuration
- Volume mounts
- Environment variables (non-sensitive)

---

## Global Flags

These flags work with most commands:

### `--verbose`

Show detailed output including:

- SSH connection details
- Docker command execution
- Build progress
- Deployment steps
- Error diagnostics

```bash
iop deploy --verbose
iop setup --verbose
iop status --verbose
```

### `--config` / `-c`

Use a specific configuration file instead of `iop.yml`:

```bash
iop deploy -c iop.staging.yml
iop deploy -c iop.production.yml
iop setup -c environments/prod.yml
```

This enables multi-environment deployments with different configurations.

---

## Command Chaining

Common command sequences for different workflows:

### First Deployment

```bash
iop init                            # Initialize project
# Edit iop.yml and .iop/secrets
iop setup                           # Prepare servers
iop deploy                          # Deploy apps
iop status                          # Verify deployment
```

### Regular Deployments

```bash
iop deploy                          # Deploy latest changes
iop status                          # Check status
```

### Multi-Environment Workflow

```bash
# Deploy to staging
iop deploy -c iop.staging.yml

# Deploy to production
iop deploy -c iop.production.yml

# Check production status
iop status -c iop.production.yml
```

### Service Management

```bash
iop deploy --services               # Deploy/update services
iop status --verbose                # Check all services
```

---

## Exit Codes

iop commands return standard exit codes:

- **0** - Success
- **1** - General error (configuration, network, etc.)
- **2** - Command line usage error
- **130** - Interrupted by user (Ctrl+C)

This makes iop suitable for use in CI/CD pipelines:

```bash
#!/bin/bash
iop deploy -c iop.production.yml
if [ $? -eq 0 ]; then
    echo "‚úÖ Deployment successful"
else
    echo "‚ùå Deployment failed"
    exit 1
fi
```
